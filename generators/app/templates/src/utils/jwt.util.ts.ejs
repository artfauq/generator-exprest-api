import jwt from 'jsonwebtoken';
import { config } from '../config';
import { JWTPayload } from '../types';
import { generateUUID } from './string.util';

/**
 * Generates and returns a signed JWT.
 */
export const generateSignedJWT = (userId: string, payload: JWTPayload): string => {
  return jwt.sign(payload, config.secret, {
    algorithm: 'HS256',
    issuer: config.publicHost,
    subject: userId,
    jwtid: generateUUID(),
  });
};
